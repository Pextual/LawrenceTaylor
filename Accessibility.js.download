(window.webpackJsonp=window.webpackJsonp||[]).push([[115],{375:function(e,t,n){"use strict";n.r(t),function(e,i,a){var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();function r(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function i(a,o){try{var r=t[a](o),s=r.value}catch(e){return void n(e)}if(!r.done)return Promise.resolve(s).then(function(e){i("next",e)},function(e){i("throw",e)});e(s)}("next")})}}var s=new(function(){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),t.instance||(this._init(),t.instance=this),t.instance}return o(t,[{key:"_init",value:function(){var t=this;this.lastFocusedElement=e(".skipLink"),this.isProd="prod"===$Y.environment,this.elementFocusable="a:visible, select:visible, input:visible, button:visible, textarea:visible,*[tabindex=0]:visible",this.radioButtonOn=!0,i.watch({"ST::PLAYER::VIDEO_IS_LOADED":function(){t.focusOnVideoControl()}}),this.dropdownFocusManager(),this._handelEvents(),this._inputBirthdaySelection(),this._accessibleRadioButton(),this._initAddToBagDisabledButton()}},{key:"_getGlobals",value:function(){var e=r(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.globals){e.next=4;break}return e.next=3,n.e(148).then(n.bind(null,546));case 3:this.globals=e.sent.default;case 4:return e.abrupt("return",this.globals);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"_handelEvents",value:function(){var t=this;e(document.body).one("focusin",function(){t._getNotificationsBox()}),i.watchOne({"ST::ACCESSIBILITY::RADIOBUTTON":function(){t._accessibleRadioButton()}}),i.watch({"yTos::Search::filtersUpdated":function(){t._setFilterInputAriaValid()},"ST::LAYER::SHOWMINICART":function(e){setTimeout(function(){t.focusElement(".minibag-layer",!0)},1e3)},"yTos::Cart::MiniCartUpdated":function(e){setTimeout(function(){t.focusElement(".minibag-layer",!0)},1e3)},"yTos::AjaxForm::ScrollToErrorReady":function(){var t=e("input.invalid");t.length>0&&(t.first().is("[data-ytos-radiogroup-value]")?t.first().siblings().find("input").first().focus():t.first().focus())},"yTos::AjaxForm::FormValidated":function(e){t._setAllInputAndSelectAriaValid(e)},"yTos::AjaxForm::InputValidated":function(n){e(t.lastFocusedElement).is(".invalid")?t._setInputAndSelectAriaValid(!1):e(t.lastFocusedElement).is(".valid")&&t._setInputAndSelectAriaValid(!0)}}),e(".navigation-section").one("focusin","button,a",function(){t._addLangAttributeToMenu()})}},{key:"_inputBirthdaySelection",value:function(){var t=r(regeneratorRuntime.mark(function t(){var n,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._getGlobals();case 2:n=t.sent.getKeyCode(),(i=a.Event("keydown")).which=n.RETURN,i.keyCode=n.RETURN,e("body").on("keydown",".selectInput_wrapper select",function(t){var a=e(t.target),o=a.siblings(".jcf-select").hasClass("jcf-drop-active");t.which!=n.TAB&&t.which!=n.ESC||o&&a.siblings(".jcf-select").removeClass("jcf-drop-active jcf-drop-flipped").find(".jcf-select-drop").remove(),t.which!=n.DOWN&&t.which!=n.UP||o||e(t.target).trigger(i)});case 7:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"saveLastFocusedElement",value:function(t){"searchInput"!==e(t).attr("id")&&(this.lastFocusedElement=e(t))}},{key:"focusOnVideoControl",value:function(){var t=this,n=e(".video-player .video-js");e(".vjs-control-bar").on("focusin",function(e){n.hasClass("vjs-user-active")&&n.removeClass("not-hover")}),e(".vjs-control-bar").on("click tap",".vjs-fullscreen-control",function(n){setTimeout(function(){e(".video-js").hasClass("vjs-fullscreen")?t.focusElement(e(".video-js"),!0):t.unFocusElement(e(".video-js"),!0)},1e3)}),i.watch({"ST::PLAYER::HIDEINFOBOX":function(){e(".slot-video-box .description").attr("tabindex","-1")},"ST::PLAYER::SHOWINFOBOX":function(){e(".slot-video-box .description").attr("tabindex","0")}})}},{key:"getCurrentFocusedElement",value:function(){return document.activeElement||e(".focusOn")}},{key:"removeOutlineOnClick",value:function(){var t=r(regeneratorRuntime.mark(function t(){var n,i,a,o=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._getGlobals();case 2:n=t.sent.getKeyCode(),i=new Date,a=new Date,e(document).on("mousedown tap",function(){a=new Date}),e(document).on("keydown",function(e){"undefined"!==e.keyCode&&e.keyCode===n.TAB&&(i=new Date)}),e(document).on("focusin",function(t){e(".focusOn").removeClass("focusOn"),o.lastFocusedElement=e(t.target),a>=i?e(t.target).addClass("non-keyboard-outline"):e(t.target).removeClass("non-keyboard-outline"),!o.isProd&&console.log(t.target)});case 8:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"disableAccessibilityToNavigationMenuClone",value:function(){var t=e(".midnightHeader.light_navigation").length>0,n=e(".gtpl-container").first();if(t||0!=n.length){var i=n.data("navigation-color")||"";e(".midnightHeader."+("string"==typeof i&&""===i?"light":"dark")+"_navigation").find("a, button").attr({"aria-hidden":"true",tabindex:"-1"})}}},{key:"enableMenuNavigationAccessibile",value:function(t){var n=!0,i="-1";t&&(n=!1,i="0"),e(".navigation-section").find("a, button").attr({"aria-hidden":n,tabindex:i})}},{key:"setFocusAfterSkipToMainContent",value:function(){var t=this;e(window).on("hashchange",function(e){t.focusElement(document.getElementById(location.hash.substring(1)),!1)})}},{key:"focusElement",value:function(){var t=r(regeneratorRuntime.mark(function t(n){var i,a,o,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._getGlobals();case 2:i=t.sent.getKeyCode(),n&&(a=e(n),o=e(n),r&&(a=e(n).find(this.elementFocusable).first(),(o=e(n).find(this.elementFocusable).last()).on("keydown",function(e){"Tab"!==e.key&&e.keyCode!==i.TAB||e.shiftKey||(a.focus().addClass("focusOn"),e.preventDefault())}),a.on("keydown",function(e){"Tab"!==e.key&&e.keyCode!==i.TAB||!e.shiftKey||(o.focus().addClass("focusOn"),e.preventDefault())})),a.focus().addClass("focusOn"));case 4:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"unFocusElement",value:function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(t){var i=e(t);e(t);n&&(i=e(t).find(this.elementFocusable).first(),e(t).find(this.elementFocusable).last().unbind("keydown"),i.unbind("keydown"))}}},{key:"uiScaleAccessibility",value:function(e){var t="gesturestart",n=[1,1],i="querySelectorAll"in e?e.querySelectorAll("meta[name=viewport]"):[];function a(){i.content="width=device-width,minimum-scale="+n[0]+",maximum-scale="+n[1],e.removeEventListener(t,a,!0)}((i=i[i.length-1])&&"addEventListener"in e&&navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/ipad/i))&&(a(),n=[.25,1.6],e.addEventListener(t,a,!0))}},{key:"dropdownFocusManager",value:function(){var t=r(regeneratorRuntime.mark(function t(){var i=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e(document.body).on("focus",'[aria-haspopup="listbox"]',function(){var t=r(regeneratorRuntime.mark(function t(a){var o,r,s,u;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e(a.target).is("[data-listbox-acc]")){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,n.e(170).then(n.bind(null,590));case 4:return o=t.sent.default,t.next=7,n.e(171).then(n.bind(null,591));case 7:r=t.sent.default,s=e(a.target),u=new o(s.siblings("[role=listbox]")),new r(s,u);case 11:case"end":return t.stop()}},t,i)}));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"_accessibleRadioButton",value:function(){var t=this;this._setupAriaCheckedForRadioButtons(),e(document.body).on("keydown",'[role="radiogroup"]',function(n){e(n.target).is("ul")&&t._radiobuttonHandleKeyDown(n)})}},{key:"_setupAriaCheckedForRadioButtons",value:function(){e("[role=radio]").filter(function(t,n){return e(n).hasClass("selected")}).each(function(t,n){return e(n).attr("aria-checked","true")})}},{key:"_radiobuttonHandleKeyDown",value:function(){var t=r(regeneratorRuntime.mark(function t(n){var i,a,o,r,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._getGlobals();case 2:i=t.sent.getKeyCode(),a=e(n.target),o=a.find(".selected"),r=o.attr("id"),a.attr("aria-activedescendant",r),s=this._getCurrentRadioButton(a),t.t0=n.keyCode,t.next=t.t0===i.UP?11:t.t0===i.LEFT?11:t.t0===i.DOWN?15:t.t0===i.RIGHT?15:19;break;case 11:return n.preventDefault(),o.attr("aria-checked","false"),this._setCheckedRadioButton(s,!1),t.abrupt("break",20);case 15:return n.preventDefault(),o.attr("aria-checked","false"),this._setCheckedRadioButton(s,!0),t.abrupt("break",20);case 19:return t.abrupt("break",20);case 20:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"_setCheckedRadioButton",value:function(t,n){var i,a=e(t).parents('[role="radiogroup"]'),o=a.find("> li");(t=n?t.next().length?t.next():o.eq(0):t.prev().length?t.prev():o.eq(o.length-1)).click(),t.attr("aria-checked","true"),i=t.attr("id"),a.attr("aria-activedescendant",i)}},{key:"_getCurrentRadioButton",value:function(e){return e.find(".selected").length?e.find(".selected"):e.children().first()}},{key:"_hideIFramesNotInGrid",value:function(){e("iframe").filter(function(t,n){return!e(n).parents().hasClass("gtpl-grid")}).each(function(t,n){return e(n).addClass("hidden")})}},{key:"_getNotificationsBox",value:function(){var t=this;"undefined"==typeof yTos&&(yTos={}),void 0===yTos.accessibility&&(yTos.accessibility={}),e.ajax({type:"GET",url:"/Store/RenderAccessibilityNotificationBox"}).then(function(e){var t=e.split("\n").join("");return t=t.split("[")[1].split("]")[0],JSON.parse("["+t+"]")}).then(function(e){yTos.accessibility.notificationBox={notifications:e},yTos.accessibility.notificationBox.delay=500,t._runNotificationBoxSetup()})}},{key:"_runNotificationBoxSetup",value:function(){if(function(){var e=$Y.safeGet(yTos,"accessibility.notificationBox.notifications");return e&&e.length>0}()){var t=e("[data-ytos-notification-box-assertive]"),n=e("[data-ytos-notification-box-polite]"),i="",a="",o=$Y.debounce(function(){t.append(i),i="",n.append(a),a=""},yTos.accessibility.notificationBox.delay);yTos.accessibility.notificationBox.notifications.forEach(function(e){var t={};t[e.Notification]=r.bind(null,e),$Y.watch(t,{scope:e.Scope})})}function r(r){t.find("[data-ytos-notification-box-message]").css("display","none"),n.find("[data-ytos-notification-box-message]").css("display","none"),function(t){var n=e(t.Selector);if(0===n.length)return;var o=$Y.stringFormat("<div data-ytos-notification-box-message>{0}</div>",n.html());"polite"===t.AriaType?a+=o:i+=o}(r),o()}}},{key:"_addLangAttributeToMenu",value:function(){e(".menuItem[data-target-parameters]").each(function(t,n){var i=e(n).data("target-parameters");i.indexOf("lang")>=0&&(i=/lang=(?:.*&|.*)/.exec(i)[0].replace("&","").split("="),e(n).find("button,a").first().attr(i[0],i[1]))})}},{key:"_setInputAndSelectAriaValid",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments[1],n=t?t.find("input, select"):this.lastFocusedElement,i=(t||n.parents("[data-ytos-input-container]")).find("[data-ytos-validation-msg]"),a="Error_"+n.attr("id");e?n.removeAttr("aria-describedby aria-invalid"):(i.is("id")||i.attr("id",a),n.attr({"aria-invalid":!0,"aria-describedby":a}))}},{key:"_setAllInputAndSelectAriaValid",value:function(t){var n=this;e(t.form).find(".invalidRow").each(function(t,i){n._setInputAndSelectAriaValid(!1,e(i))})}},{key:"_initAddToBagDisabledButton",value:function(){document.querySelector(".addItemToShoppingBagButton[aria-disabled=true]")&&(e(".addItemToShoppingBagButton[aria-disabled=true]").attr("aria-describedby","error-addbutton-disabled"),i.watch({"yTos::Item::SizeChanged":function(){e(".addItemToShoppingBagButton[aria-disabled=false]").removeAttr("aria-describedby")}}))}},{key:"_setFilterInputAriaValid",value:function(){e(".search-filters-container li").find("input").removeAttr("disabled"),e(".search-filters-container li.disabled").find("input").attr("disabled","")}}]),t}());t.default=s}.call(this,n(4),n(8),n(4))}}]);
//# sourceMappingURL=Accessibility.js.map